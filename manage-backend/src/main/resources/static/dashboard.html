<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>数据管理系统</title>
    <meta name="description" content="">


    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- Bootstrap CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/numberAnimate.css" rel="stylesheet" type="text/css" />
    <!-- Font Awesome CSS -->
    <link href="assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

    <!-- Custom CSS -->
    <link href="assets/css/style.css" rel="stylesheet" type="text/css" />

    <!-- BEGIN CSS for this page -->
    <link rel="stylesheet" type="text/css" href="assets/css/dataTables.bootstrap4.min.css"/>
    <!-- END CSS for this page -->

</head>

<body class="adminbody">

<div id="main">

    <div class="headerbar">
        <!-- LOGO -->
        <div class="headerbar-left">
            <a href="index.html" class="logo"><img alt="Logo" src="assets/images/logo.png" /> <span>Admin</span></a>
        </div>
        <nav class="navbar-custom">
        </nav>

    </div>


    <div>

        <!-- Start content -->
        <div class="content">

            <div class="container-fluid">

                <div class="row">
                    <div class="col-xl-12">
                        <div class="breadcrumb-holder">
                            <h1 class="main-title float-left">Dashboard</h1>
                            <ol class="breadcrumb float-right">
                                <li class="breadcrumb-item">Home</li>
                                <li class="breadcrumb-item active">Dashboard</li>
                            </ol>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
                <!-- end row -->



                <div class="row">
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-3">
                        <div class="card-box noradius noborder bg-default">
                            <i class="fa fa-file-text-o float-right text-white"></i>
                            <h6 class="text-white text-uppercase m-b-20">正在运行任务</h6>
                            <h1 class="m-b-20 text-white counter"><div class="numberRun1">1,587</div></h1>
                            <span class="text-white"><div class="numberRunSub1">其中有 14 个归档任务</div></span>
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-3">
                        <div class="card-box noradius noborder bg-warning">
                            <i class="fa fa-bell-o float-right text-white"></i>
                            <h6 class="text-white text-uppercase m-b-20">即将执行任务</h6>
                            <h1 class="m-b-20 text-white counter"><div class="numberRun4">250</div></h1>
                            <span class="text-white"><div class="numberRunSub4">其中有 14 个归档任务</div></span>
                        </div>
                    </div>

                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-3">
                        <div class="card-box noradius noborder bg-info">
                            <i class="fa fa-bar-chart float-right text-white"></i>
                            <h6 class="text-white text-uppercase m-b-20">已完成任务</h6>
                            <h1 class="m-b-20 text-white counter"><div class="numberRun2">250</div></h1>
                            <span class="text-white"><div class="numberRunSub2">其中有 14 个归档任务</div></span>
                        </div>
                    </div>

                    <div class="col-xs-12 col-md-6 col-lg-6 col-xl-3">
                        <div class="card-box noradius noborder  bg-danger">
                            <i class="fa fa-user-o float-right text-white"></i>
                            <h6 class="text-white text-uppercase m-b-20">执行错误任务</h6>
                            <h1 class="m-b-20 text-white counter"><div class="numberRun3">250</div></h1>
                            <span class="text-white"><div class="numberRunSub3">其中有 14 个归档任务</div></span>
                        </div>
                    </div>


                </div>
                <!-- end row -->



                <div class="row">

                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-6">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3><i class="fa fa-line-chart"></i> 数据存储情况</h3>
                                展示15天内每天的数据存储情况，数据存储单位为Gb.（<每个数据集的总大小与当前存储大小对比展示>）
                            </div>

                            <div class="card-body">
                                <canvas id="lineChart"></canvas>
                            </div>
                            <div class="card-footer small text-muted">2020年6月4日 20:11:19 更新</div>
                        </div><!-- end card-->
                    </div>

                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-3">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3><i class="fa fa-bar-chart-o"></i> 原始数据归档容量</h3>
                                展示原始数据归档的容量前十的数据容量信息，并显示每个数据集的名称以及使用量（单位为GB）。
                            </div>

                            <div class="card-body">
                                <canvas id="pieChart"></canvas>
                            </div>
                            <div class="card-footer small text-muted">更新时间为2020年6月3日11:59:34</div>
                        </div><!-- end card-->
                    </div>

                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-3">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3><i class="fa fa-bar-chart-o"></i>产品数据归档容量</h3>
                                展示原始数据归档的容量前十的数据容量信息，并显示每个数据集的名称以及使用量（单位为GB）。
                            </div>

                            <div class="card-body">
                                <canvas id="doughnutChart"></canvas>
                            </div>
                            <div class="card-footer small text-muted">更新时间为2020年6月3日11:59:34</div>
                        </div><!-- end card-->
                    </div>

                </div>
                <!-- end row -->


                <div class="row">

                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-6">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3><i class="fa fa-users"></i> 所有数据集的总容量与使用量展示</h3>
                                每一种数据所存储的空间展示, 展示的容量与使用量的单位为GB。当数据增加时此表会自动刷新近实时的展示各数据存储的使用情况。
                            </div>

                            <div class="card-body">

                                <table id="example1" class="table table-bordered table-responsive-xl table-hover display">

                                </table>

                            </div>
                        </div><!-- end card-->
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-3">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3><i class="fa fa-star-o"></i> 当前任务进程</h3>
                                展示正在运行的所有任务的实时情况.
                            </div>

                            <div class="card-body" id="taskOutline">
<!--                                <p class="font-600 m-b-5">崔飞导出任务测试1<span class="text-primary pull-right"><b>95%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-primary" role="progressbar" style="width: 95%" aria-valuenow="95" aria-valuemin="0" aria-valuemax="95"></div>-->
<!--                                </div>-->
<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">下载测试<span class="text-primary pull-right"><b>88%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-primary" role="progressbar" style="width: 88%" aria-valuenow="88" aria-valuemin="0" aria-valuemax="88"></div>-->
<!--                                </div>-->

<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">601回调任务断点<span class="text-info pull-right"><b>75%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-info" role="progressbar" style="width: 78%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="75"></div>-->
<!--                                </div>-->

<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">601回调任务<span class="text-info pull-right"><b>70%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-info" role="progressbar" style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="70"></div>-->
<!--                                </div>-->

<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">601恢复任务<span class="text-warning pull-right"><b>68%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-warning" role="progressbar" style="width: 68%" aria-valuenow="68" aria-valuemin="0" aria-valuemax="68"></div>-->
<!--                                </div>-->

<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">530回调任务<span class="text-warning pull-right"><b>65%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-warning" role="progressbar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="65"></div>-->
<!--                                </div>-->

<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">我的远红外测试一<span class="text-danger pull-right"><b>55%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-danger" role="progressbar" style="width: 55%" aria-valuenow="55" aria-valuemin="0" aria-valuemax="55"></div>-->
<!--                                </div>-->

<!--                                <div class="m-b-20"></div>-->

<!--                                <p class="font-600 m-b-5">飞来测试任务<span class="text-danger pull-right"><b>40%</b></span></p>-->
<!--                                <div class="progress">-->
<!--                                    <div class="progress-bar progress-bar-striped progress-xs bg-danger" role="progressbar" style="width: 40%" aria-valuenow="40" aria-valuemin="0" aria-valuemax="40"></div>-->
<!--                                </div>-->


                            </div>
                            <div class="card-footer small text-muted">Updated today at 11:59 PM</div>
                        </div><!-- end card-->
                    </div>


                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-3">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3><i class="fa fa-envelope-o"></i> 任务实时信息</h3>
                                集合所有任务实时更新信息展示，显示左侧选中的一个任务信息。
                            </div>

                            <div class="card-body">

                                <div class="widget-messages nicescroll" style="height: 400px;">
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                    <a href="#">
                                        <div class="message-item">
                                            <div class="message-user-img"><img style="width:20px;" src="assets/images/avatars/68.gif" class="avatar-circle" alt=""></div>
                                            <p class="message-item-user">崔飞导出任务测试1</p>
                                            <p class="message-item-msg">当前进度为50%，共有归档文件为6个。正在归档第三个文件</p>
                                            <p class="message-item-date">11:50 PM</p>
                                        </div>
                                    </a>
                                </div>

                            </div>
                            <div class="card-footer small text-muted">Updated today at 11:59 PM</div>
                        </div><!-- end card-->
                    </div>



                </div>



            </div>
            <!-- END container-fluid -->

        </div>
        <!-- END content -->

    </div>
    <!-- END content-page -->


</div>
<!-- END main -->

<script src="assets/js/modernizr.min.js"></script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/moment.min.js"></script>

<script src="assets/js/popper.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>

<script src="assets/js/detect.js"></script>
<script src="assets/js/fastclick.js"></script>
<script src="assets/js/jquery.blockUI.js"></script>
<script src="assets/js/jquery.nicescroll.js"></script>

<!-- App js -->
<script src="assets/js/pikeadmin.js"></script>

<!-- BEGIN Java Script for this page -->
<script src="js/Chart.min.js"></script>
<script src="js/jquery.dataTables.min.js"></script>
<script src="js/dataTables.bootstrap4.min.js"></script>

<!-- Counter-Up-->
<script src="assets/plugins/waypoints/lib/jquery.waypoints.min.js"></script>
<script src="assets/plugins/counterup/jquery.counterup.min.js"></script>
<script src="assets/plugins/numberAnimate.js"></script>
<script src="js/constant.js"></script>
<script type="text/javascript" src="js/jq.js"></script>
<script>
    $(document).ready(function() {

    } );
</script>

<script>
    var tasklist ={};
    $.ajax({
        type : 'get',
        url : domainName + '/api-b/findDict?dictType='+encodeURIComponent("任务内容类型"),
        async:false,
        success : function(data) {
            for (var j = 0; j < 5; j++) {
                var strTmps = "";
                for (var i = 0; i < data.length; i++) {
                        strTmps += ","+data[i].dictName+":0个";
                }
                $('.numberRunSub'+j).text(strTmps.substr(1));
            }
            tasklist=data;
        }
    });
    var numFinish1 = 0;
    var numFinish2 = 0;
    var numFinish3 = 0;
    var numFinish4 = 0;
    var numFinish5 = 0;
    var numRun1=$(".numberRun1").numberAnimate({
        num: "0",
        speed: 2000,
        symbol: ","
    });
    var numRun2=$(".numberRun2").numberAnimate({
        num: "0",
        speed: 2000,
        symbol: ","
    });
    var numRun3=$(".numberRun3").numberAnimate({
        num: "0",
        speed: 2000,
        symbol: ","
    });
    var numRun4=$(".numberRun4").numberAnimate({
        num: "0",
        speed: 2000,
        symbol: ","
    });
    var numRun5=$(".numberRun5").numberAnimate({
        num: "0",
        speed: 2000,
        symbol: ","
    });
    setInterval(finishStatus1, 5000);
    //===================完成任务===============
    function finishStatus1() {
        var requestObj={};
        $.ajax({
            type : 'get',
            url : domainName + '/api-p/pof/getListTask/getListTaskByParamsDescription',
            timeout : 5000, //超时时间设置，单位毫秒
            data : requestObj,
            success : function(data) {
                data = eval("("+data+")");
                for(var o in  data)
                {
                    var tmptotal = 0;
                    var strTmps ="";
                    for (var i = 0; i < tasklist.length; i++) {
                        var isHave = false;
                        for(var os in data[o])
                        {
                            if(tasklist[i].dictValue == os)
                            {
                                strTmps += ","+tasklist[i].dictName+":"+data[o][os]+"个";
                                tmptotal += data[o][os];
                                isHave=true;
                                break;
                            }
                        }
                        if(!isHave)
                        {
                            strTmps += ","+tasklist[i].dictName+":0个";
                        }
                    }
                    eval("numRun"+o+".resetData("+tmptotal+")");
                    $('.numberRunSub'+o).text(strTmps.substr(1));
                }
            },
            error : function(xhr, textStatus, errorThrown) {

            }
        });
    }

    $.ajax({
        type : 'get',
        url : domainName + '/api-p/SystemInfo/dataCollectionContentTotal15',
        timeout : 5000, //超时时间设置，单位毫秒
        data : {},
        success : function(data) {
            var labels = Object.keys(data);
            labels = labels.sort();
            var preDataa=[];
            var proDataa =[];
            var preFiveObject = {};
            var proFiveObject = {};
            for (var i = 0; i < Object.keys(data).length; i++) {
                var datasourceTmp = eval("("+data[labels[i]]+")");
                var datasource_ = datasourceTmp.datasource;
                var preDataTmp = 0;
                var proDataTmp =0;
                for (var j = 0; j < Object.keys(datasource_).length; j++) {
                    var datasourceName = Object.keys(datasource_)[j];
                    var datacollectionTmp = datasource_[Object.keys(datasource_)[j]];
                    for (var k = 0; k < Object.keys(datacollectionTmp).length; k++) {
                        var content = datacollectionTmp[Object.keys(datacollectionTmp)[k]];
                        console.log(content);
                        if(datasourceName.indexOf("_") == -1)
                        {
                            preDataTmp += parseInt(content.usespace);
                            preFiveObject[Object.keys(datacollectionTmp)[k]] = parseInt(content.usespace);
                        }
                        else
                        {
                            proDataTmp += parseInt(content.usespace);
                            proFiveObject[Object.keys(datacollectionTmp)[k]] = parseInt(content.usespace);
                        }
                    }
                }
                preDataTmp =(Number(preDataTmp)/(1024*1024*1024)).toFixed(4);
                proDataTmp =(Number(proDataTmp)/(1024*1024*1024)).toFixed(4);
                preDataa.push(preDataTmp);
                proDataa.push(proDataTmp);
            }
            lineChartStorage(labels,preDataa,proDataa);
        },
        error : function(xhr, textStatus, errorThrown) {

        }
    });
   function lineChartStorage(labelss,preDataa,proDataa) {
       var labels =labelss;// ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
       var preData =preDataa;// [10, 14, 6, 7, 13, 9, 13, 16, 11, 8, 12, 9];
       var proData = proDataa;//[12, 14, 6, 7, 13, 6, 13, 16, 10, 8, 11, 12];
       var ctx1 = document.getElementById("lineChart").getContext('2d');
       var lineChart = new Chart(ctx1, {
           type: 'bar',
           data: {
               labels: labels,
               datasets: [{
                   label: '产品数据存储量',
                   backgroundColor: '#3EB9DC',
                   data: preData
               }, {
                   label: '原始数据存储量',
                   backgroundColor: '#EBEFF3',
                   data: proData
               }]

           },
           options: {
               tooltips: {
                   mode: 'index',
                   intersect: false
               },
               responsive: true,
               scales: {
                   xAxes: [{
                       stacked: true,
                   }],
                   yAxes: [{
                       stacked: true
                   }]
               }
           }
       });
   }

    var date = new Date();
    var fullYear1 = date.getFullYear();
    var month1 = date.getMonth()+1;
    var date1 = date.getDate();
    var po = {};
    po.startTime = "1980-01-01 00:00:00";
    po.endTime = fullYear1+"-"+(month1<10?("0"+month1):(month1))+"-"+(date1<10?("0"+date1):(date1))+" 23:59:59";
    po.pof = true;
    $.ajax({
        type : 'get',
        url : domainName + '/api-p/SystemInfo/dataCollectionContentTotal',
        timeout : 5000, //超时时间设置，单位毫秒
        data : po,
        success : function(data) {
            debugger;
            if(data.respCode == 1)
            {
                var orginData = [];
                var orginDataCollection = [];
                var proData = [];
                var proDataDataCollection = [];
                var dataCollectionTotal = [];
                var datasourceMap = eval("("+decodeURIComponent(data.respMap.result)+")").datasource;
                for (var i = 0; i < Object.keys(datasourceMap).length; i++) {
                    var key = Object.keys(datasourceMap)[i];
                    var dataCollectionMap = datasourceMap[key];
                    for (var j = 0; j < Object.keys(dataCollectionMap).length; j++) {
                        var dataCollectionKey = Object.keys(dataCollectionMap)[j];
                        var usespace = dataCollectionMap[dataCollectionKey].usespace;
                        usespace = parseInt(usespace);
                        usespace =Number(usespace)/(1024*1024*1024);
                        usespace.toFixed(4);
                        var _tmpObj = {};
                        _tmpObj = dataCollectionMap[dataCollectionKey];
                        _tmpObj.name = dataCollectionKey;
                        _tmpObj.datasourcename = key;
                        _tmpObj.time = po.endTime;
                        dataCollectionTotal.push(_tmpObj);
                        if(key.indexOf("_") == -1)
                        {
                            //表示产品数据
                            proData.push(usespace);
                            proDataDataCollection.push(dataCollectionKey);
                        }
                        else
                        {
                            //原始数据
                            orginData.push(usespace);
                            orginDataCollection.push(dataCollectionKey);
                        }
                    }

                }
                dataCollectionTable(dataCollectionTotal);
                orginData.sort(sortNumber);
                proData.sort(sortNumber);
                startPieChart(orginData,proData,orginDataCollection,proDataDataCollection);
            }
        },
        error : function(xhr, textStatus, errorThrown) {

        }
    });
    function sortNumber(a,b) {
        return b-a;
    }
    function dataCollectionTable(_objsArray) {
        var _tmpString = "<thead>\n" +
            "                                    <tr>\n" +
            "                                        <th>数据源名称</th>\n" +
            "                                        <th>数据集名称</th>\n" +
            "                                        <th>总量</th>\n" +
            "                                        <th>使用量</th>\n" +
            "                                        <th>数据个量</th>\n" +
            "                                        <th>获取时间</th>\n" +
            "                                    </tr>\n" +
            "                                    </thead>\n" +
            "                                    <tbody>\n";
        var innerH = "";
        for (var i = 0; i < _objsArray.length; i++) {
            innerH +=  "                                    <tr>\n" +
                "                                        <td>"+_objsArray[i].datasourcename+"</td>\n" +
                "                                        <td>"+_objsArray[i].name+"</td>\n" +
                "                                        <td>"+_objsArray[i].totalspace+"</td>\n" +
                "                                        <td>"+_objsArray[i].usespace+"</td>\n" +
                "                                        <td>"+_objsArray[i].count+"</td>\n" +
                "                                        <td>"+_objsArray[i].time+"</td>\n" +
                "                                    </tr>";
        }
        innerH += "</tbody>";
        document.getElementById("example1").innerHTML=_tmpString+innerH;
        $('#example1').DataTable();
    }
    function startPieChart(data1,data3,data11,data33) {
        var bg = [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            //'rgba(153, 102, 255, 1)',
            'rgba(255, 159, 64, 1)'
        ];
        var lb = [
            "Red",
            "Orange",
            "Yellow",
            "Green",
            "Blue"
        ];
        if(data1.length >5)
        {
            data1 = data1.slice(0,5);
        }
        else
        {
            bg = bg.slice(0,data1.length);
            lb = lb.slice(0,data1.length);
        }
        var ctx2 = document.getElementById("pieChart").getContext('2d');
        var pieChart = new Chart(ctx2, {
            type: 'pie',
            data: {
                datasets: [{
                    data: data1,
                    backgroundColor: bg,
                    label: '原始数据'
                }],
                labels: data11
            },
            options: {
                responsive: true
            }

        });

        var bg3 = [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            'rgba(255, 159, 64, 1)'
        ];
        var lb3 = [
            "Red",
            "Orange",
            "Yellow",
            "Green",
            "Blue"
        ];
        if(data3.length >5)
        {
            data3 = data3.slice(0,5);
        }
        else
        {
            bg3 = bg3.slice(0,data3.length);
            lb3 = lb3.slice(0,data3.length);
        }
        var ctx3 = document.getElementById("doughnutChart").getContext('2d');
        var doughnutChart = new Chart(ctx3, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: data3,
                    backgroundColor: bg3,
                    label: '产品数据'
                }],
                labels: data33
            },
            options: {
                responsive: true
            }

        });
    }
    setInterval(startTaskOutline, 5000);
    function startTaskOutline()
    {
        $.ajax({
            type : 'get',
            url : domainName + '/api-p/pof/getListTask/getListTaskByParams',
            timeout : 5000, //超时时间设置，单位毫秒
            data : {status:1},
            success : function(data) {
            debugger;
                showTaskOutline(data);
                //获取任务名称、任务类型、百分比进度
            },
            error : function(xhr, textStatus, errorThrown) {

            }
        });
    }

    function showTaskOutline(data) {
        var tmpInner = "";
        for (var i = 0; i < data.length; i++) {
            var model1 = "<p class=\"font-600 m-b-5\">"+data[i].name+"<span class=\"text-primary pull-right\"><b>95%</b></span></p>\n" +
                "                                <div class=\"progress\">\n" +
                "                                    <div class=\"progress-bar progress-bar-striped progress-xs bg-primary\" role=\"progressbar\" style=\"width: 95%\" aria-valuenow=\"95\" aria-valuemin=\"0\" aria-valuemax=\"95\"></div>\n" +
                "                                </div>\n" +
                "                                <div class=\"m-b-20\"></div>";
            tmpInner += model1;
        }

        document.getElementById("taskOutline").innerHTML = tmpInner;
    }
</script>
<!-- END Java Script for this page -->

</body>
</html>